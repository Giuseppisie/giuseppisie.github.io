<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>WavGuard — Smart Wakeboard</title>

  <style>
    :root{
      --bg: #a0c0bc;
      --card: #427b76;
      --accent: #b0ab52;
      --content-max: 1100px;
      --gap: 28px;
    }
    html,body{height:100%;margin:0;}
    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      background: var(--bg);
      color:#111;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* topbar + hero */
    .topbar{position:fixed;inset:0 0 auto 0;height:60px;display:flex;align-items:center;justify-content:space-between;padding:0 20px;z-index:1000;background:rgba(0,0,0,0.22);backdrop-filter:blur(4px);}
    .brand{color:#fff;font-weight:800;font-size:18px;text-shadow:0 2px 8px rgba(0,0,0,.4);}
    .topbar a{color:#fff;text-decoration:none;font-weight:700;background:var(--card);padding:8px 12px;border-radius:8px;}
    .spacer{height:60px;}
    .hero{position:relative;height:70vh;width:100%;background-image:url("../images/wavguard/wavguardfull.png");background-size:cover;background-position:center;display:flex;align-items:center;justify-content:center;}
    .hero::after{content:"";position:absolute;inset:0;background:rgba(66,123,118,0.35);}
    .hero-title{position:relative;z-index:1;color:#fff;font-size:clamp(28px,5vw,48px);font-weight:800;text-shadow:0 8px 24px rgba(0,0,0,.6);padding:0 20px;text-align:center;}

    /* content area */
    .content{padding:40px 20px 32px;max-width:var(--content-max);margin:0 auto;}
    .project-intro{background:#fff;border-radius:12px;padding:32px;box-shadow:0 8px 20px rgba(0,0,0,0.08);margin:0 auto 28px;max-width:900px;}
    .project-intro p{font-size:17px;line-height:1.7;color:#333;margin:0 0 18px 0;}
    .project-intro p:last-child{margin-bottom:0;}

    /* demo */
    .demo-wrapper{display:flex;justify-content:center;padding-bottom:24px;}
    .demo-card{background:#fff;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.08);padding:28px;width:calc(100% - 1in);max-width:var(--content-max);box-sizing:border-box;margin:0 auto;}
    .demo-grid{display:flex;gap:var(--gap);align-items:flex-start;}
    .video-col{flex:0 0 360px;width:360px;height:640px;display:flex;align-items:stretch;}
    .project-video{width:100%;height:100%;border-radius:10px;background:#000;object-fit:cover;display:block;box-shadow:0 6px 18px rgba(0,0,0,0.12);}
    .text-col{flex:1;font-size:17px;line-height:1.6;color:#333;}

    /* features grid (cards) */
    .features{margin:28px auto 40px;max-width:var(--content-max);padding:0 20px;}
    .features-heading{font-size:28px;color:#111;margin:0 0 16px 0;}
    .features-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:22px;}
    .feature-card{background:var(--card);color:#fff;border-radius:12px;overflow:hidden;box-shadow:0 8px 20px rgba(0,0,0,0.12);text-decoration:none;transition:transform .18s ease,box-shadow .18s ease;display:block;cursor:pointer;}
    .feature-card:hover{transform:translateY(-6px);box-shadow:0 20px 40px rgba(0,0,0,0.18);}
    .feature-thumb{width:100%;height:170px;object-fit:contain;background:rgba(255,255,255,0.06);padding:10px;display:block;border-top-left-radius:12px;border-top-right-radius:12px;}
    .feature-meta{padding:14px 16px 18px 16px;display:flex;flex-direction:column;gap:8px;}
    .feature-title{font-weight:700;font-size:18px;color:#fff;}
    .feature-excerpt{font-size:14px;color:rgba(255,255,255,0.9);line-height:1.35;margin:0;}
    .feature-body{display:none;} /* kept in DOM for modal extraction */

    @media(max-width:1024px){.features-grid{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:720px){.features-grid{grid-template-columns:1fr}.feature-thumb{height:44vw}.demo-card{width:calc(100% - 32px)}.video-col{width:100%;height:auto}.project-video{aspect-ratio:3/4;height:auto}}

    /* Full images area - aligned with site padding */
    .full-images{max-width:var(--content-max);margin:40px auto;padding:0 20px;}
    .full-images h2{font-size:22px;font-weight:700;color:#111;margin:0 0 16px 0;}
    .full-board{max-width:var(--content-max);margin:0 auto 20px;border-radius:12px;overflow:hidden;background:#fff;box-shadow:0 8px 20px rgba(0,0,0,0.06);cursor:zoom-in;}
    .full-board img{display:block;width:100%;height:auto;object-fit:contain;}
    .full-board .caption{padding:10px 14px;background:transparent;text-align:left}
    .full-board .caption em{color:#333;font-style:italic}

    .cad-row{max-width:var(--content-max);margin:0 auto;display:grid;grid-template-columns:repeat(2,1fr);gap:20px;align-items:start;margin-top:12px}
    .cad-row figure{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 8px 20px rgba(0,0,0,0.08);display:flex;flex-direction:column;cursor:zoom-in}
    .cad-row img{display:block;width:100%;height:420px;object-fit:contain}
    .cad-row figcaption{padding:10px 14px}
    .cad-row figcaption em{color:#333;font-style:italic}

    @media(max-width:900px){.cad-row{grid-template-columns:1fr}.cad-row img{height:auto}}

    /* ---------- Feature modal (unchanged) ---------- */
    .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.7);display:none;align-items:center;justify-content:center;z-index:2000;padding:28px}
    .modal-overlay.open{display:flex}
    .modal{background:#fff;width:100%;max-width:1100px;max-height:92vh;border-radius:12px;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 30px 80px rgba(0,0,0,0.45)}
    .modal-top{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid rgba(0,0,0,0.06);background:linear-gradient(90deg,rgba(66,123,118,1),rgba(86,153,140,1));color:#fff}
    .modal-title{font-size:20px;font-weight:800}
    .modal-close,.modal-prev,.modal-next{background:rgba(255,255,255,0.12);color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:700}
    .modal-body{display:flex;gap:20px;padding:20px;overflow:auto;background:#fff}
    .modal-img{flex:0 0 460px;max-width:52%;border-radius:8px;object-fit:contain;box-shadow:0 10px 30px rgba(0,0,0,0.18)}
    .modal-text{flex:1;color:#111;font-size:16px;line-height:1.6}
    .modal-text ul{margin-top:12px;padding-left:20px}

    @media(max-width:900px){.modal{max-width:calc(100% - 40px)}.modal-body{flex-direction:column}.modal-img{max-width:100%;width:100%;height:auto;flex:none}}

    /* ---------- Simple full-image overlay (new) ---------- */
    .img-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.85);display:none;align-items:center;justify-content:center;z-index:3000;padding:20px}
    .img-overlay.open{display:flex}
    .img-overlay .viewer{position:relative;max-width:95vw;max-height:95vh;background:transparent;display:flex;flex-direction:column;align-items:center;gap:12px}
    .img-overlay img{max-width:100%;max-height:calc(95vh - 70px);object-fit:contain;border-radius:6px;box-shadow:0 20px 60px rgba(0,0,0,0.6)}
    .img-overlay .caption{color:#fff;font-style:italic;text-align:center;max-width:95%;padding:6px 12px;background:rgba(0,0,0,0.0)}
    .img-overlay .close-btn{position:absolute;right:-6px;top:-6px;background:rgba(255,255,255,0.12);border:none;color:#fff;padding:10px 12px;border-radius:8px;cursor:pointer;font-weight:700}
    .img-overlay .close-btn:focus{outline:3px solid rgba(176,171,82,0.35);outline-offset:2px}
    .click-to-open{outline:none}
  </style>
</head>
<body>

  <!-- TOPBAR -->
  <div class="topbar">
    <div class="brand">Sienna Giuseppi</div>
    <a href="../index.html#engineering-projects">Back to projects</a>
  </div>
  <div class="spacer"></div>

  <!-- HERO -->
  <section class="hero" aria-label="Project hero image">
    <div class="hero-title">WavGuard — Smart Wakeboard</div>
  </section>

  <!-- MAIN: intro -->
  <main class="content" aria-labelledby="project-intro-heading">
    <section class="project-intro" id="project-intro">
      <p>
        WavGuard was developed to address one of the most challenging aspects of learning to wakeboard: understanding balance on an unstable, moving surface. For beginners, progress is largely driven by trial and error—while coaches can offer guidance, riders must ultimately learn how their feet distribute pressure across the board in real time. Our team set out to reduce this learning curve by providing immediate, intuitive feedback that helps riders recognize and correct their balance as they ride.
      </p>

      <p>
        Designed by a team of five engineers, WavGuard is a smart wakeboard system that delivers live visual feedback through integrated LED indicators. The board uses a combination of force-sensitive resistors (FSRs) to measure pressure distribution and an inertial measurement unit (IMU) to track orientation and motion, allowing the system to verify and contextualize rider input. All electronic components are fully padded and embedded for comfort and safety, creating a responsive training tool that supports beginners as they build confidence, balance, and technique while riding on the water.
      </p>
    </section>
  </main>

  <!-- DEMO -->
  <section class="demo-wrapper" aria-labelledby="project-demo-heading">
    <div class="demo-card" role="region" aria-label="Project demo card">
      <h2 id="project-demo-heading">Project Demo</h2>

      <div class="demo-grid">
        <div class="video-col">
          <video class="project-video" controls preload="metadata" poster="../images/wavguard/wavdemo.jpeg" playsinline>
            <source src="../images/wavguard/wavdemovid.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>

        <div class="text-col">
          <p><strong>Demo overview</strong></p>
          <p>
            This demo video was recorded during our final project presentation and shows
            WavGuard operating in real time. The system uses <strong>ratio-based logic</strong>,
            comparing relationships between sensors rather than absolute force values so it
            adapts to riders of different weights and stances.
          </p>

          <p><strong>LED feedback (quick)</strong></p>
          <ul>
            <li><strong>Blue:</strong> not enough pressure</li>
            <li><strong>Red:</strong> too much pressure</li>
            <li><strong>Green:</strong> board in equilibrium</li>
          </ul>

          <p><strong>Tilt mapping</strong></p>
          <p>
            IMU tilt maps to expected pressure by linear interpolation — e.g., 0° ~ 50/50, 15° ~ 70/30.
          </p>

          <div class="demo-note">Further technical breakdowns are in the Features below (FSR, IMU, Code Logic).</div>
        </div>
      </div>
    </div>
  </section>

  <!-- FEATURES (visible cards; modal handled later) -->
  <section class="features" aria-labelledby="features-heading">
    <h2 id="features-heading" class="features-heading">Features</h2>

    <div class="features-grid">
      <!-- (example feature card - repeat / replace content as needed) -->
      <article class="feature-card" data-index="0" role="button" tabindex="0">
        <div class="feature-summary">
          <img src="../images/wavguard/footsensor.png" alt="foot sensors" class="feature-thumb">
          <div class="feature-meta">
            <div class="feature-title">Foot Sensors (FSR)</div>
            <div class="feature-excerpt">Embedded pressure sensors measure how weight is distributed across the board.</div>
          </div>
        </div>
        <div class="feature-body" data-full="../images/wavguard/footwalkthrough.png">
          <div class="feature-text">
            <p>WavGuard uses force-sensitive resistors (FSRs) embedded beneath the rider’s feet to produce normalized ratios used by the code layer.</p>
            <ul><li>Toes vs. heels</li><li>Left vs. right</li><li>Diagonal corners</li></ul>
          </div>
        </div>
      </article>

      <article class="feature-card" data-index="1" role="button" tabindex="0">
        <div class="feature-summary">
          <img src="../images/wavguard/imu.png" alt="imu" class="feature-thumb">
          <div class="feature-meta">
            <div class="feature-title">IMU Sensor</div>
            <div class="feature-excerpt">Tracks board roll & pitch to determine tilt-based expectations.</div>
          </div>
        </div>
        <div class="feature-body" data-full="../images/wavguard/features/imu-full.jpg">
          <div class="feature-text"><p>IMU filtered to remove spikes; maps tilt to training zones (0–8°, 8–20°, &gt;22°).</p></div>
        </div>
      </article>

      <article class="feature-card" data-index="2" role="button" tabindex="0">
        <div class="feature-summary">
          <img src="../images/wavguard/pcbscematic.png" alt="code" class="feature-thumb">
          <div class="feature-meta">
            <div class="feature-title">Code Logic</div>
            <div class="feature-excerpt">Sensor fusion and mapping to LEDs.</div>
          </div>
        </div>
        <div class="feature-body" data-full="../images/wavguard/pcb.png">
          <div class="feature-text"><p>Linear interpolation from tilt to expected pressure; thresholding & debouncing before signaling LEDs.</p></div>
        </div>
      </article>

      <!-- add the rest of your feature cards here (waterproofing, electronics box, wire/LED routing) -->
      <article class="feature-card" data-index="3" role="button" tabindex="0">
        <div class="feature-summary">
          <img src="../images/wavguard/watertest.jpg" alt="waterproofing" class="feature-thumb">
          <div class="feature-meta">
            <div class="feature-title">Waterproofing</div>
            <div class="feature-excerpt">Potting, sealed glands, O-ring enclosures.</div>
          </div>
        </div>
        <div class="feature-body" data-full="../images/wavguard/watertestvid.mp4">
          <div class="feature-text"><p>O-ring sealed enclosure, potting gel for fragile connectors, marine-grade glands for wire entry.</p></div>
        </div>
      </article>

      <article class="feature-card" data-index="4" role="button" tabindex="0">
        <div class="feature-summary">
          <img src="../images/wavguard/electronicsbox.png" alt="electronics box" class="feature-thumb">
          <div class="feature-meta">
            <div class="feature-title">Electronics box</div>
            <div class="feature-excerpt">Modular enclosure, floating mount to decouple flex.</div>
          </div>
        </div>
        <div class="feature-body" data-full="../images/wavguard/features/electronicsbox.png">
          <div class="feature-text"><p>IP65-rated ABS enclosure with O-ring, threaded inserts, removable battery bay.</p></div>
        </div>
      </article>

      <article class="feature-card" data-index="5" role="button" tabindex="0">
        <div class="feature-summary">
          <img src="../images/wavguard/embed.png" alt="wiring" class="feature-thumb">
          <div class="feature-meta">
            <div class="feature-title">Wire & LED Routing</div>
            <div class="feature-excerpt">Embedded wiring channels, potting, edge LEDs & printed corner brackets.</div>
          </div>
        </div>
        <div class="feature-body" data-full="../images/wavguard/routing.png">
          <div class="feature-text"><p>Dremeled channels routed beneath pads, filled with potting gel & epoxy. Edge-mounted individually addressable LEDs.</p></div>
        </div>
      </article>

    </div>
  </section>

  <!-- FULL IMAGES (separate viewer behavior) -->
  <section class="full-images" aria-labelledby="full-images-heading">
    <h2 id="full-images-heading">Full images</h2>

    <div class="full-board click-to-open" role="button" tabindex="0"
         data-full="../images/wavguard/wavfull.png"
         data-caption="Full board — finished top surface with embedded sensors and edge LEDs">
      <img src="../images/wavguard/wavfull.png" alt="Full board" onerror="this.style.opacity=.3;">
      <div class="caption"><em>Full board — finished top surface with embedded sensors and edge LEDs</em></div>
    </div>

    <div class="cad-row">
      <figure class="click-to-open" role="button" tabindex="0"
              data-full="../images/wavguard/exploadedwav.png"
              data-caption="Exploded view — component layout">
        <img src="../images/wavguard/exploadedwav.png" alt="Exploded view" onerror="this.style.opacity=.3;">
        <figcaption><em>Exploded view — component layout</em></figcaption>
      </figure>

      <figure class="click-to-open" role="button" tabindex="0"
              data-full="../images/wavguard/cadwavexp.png"
              data-caption="Labeled CAD view — mounting points, channel routing, and enclosure placement">
        <img src="../images/wavguard/cadwavexp.png" alt="CAD view" onerror="this.style.opacity=.3;">
        <figcaption><em>Labeled CAD view — mounting points, channel routing, and enclosure placement</em></figcaption>
      </figure>
    </div>
  </section>

  <!-- FEATURE modal (existing gallery/modal) -->
  <div id="featureModal" class="modal-overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document" aria-labelledby="modal-title">
      <div class="modal-top">
        <div class="modal-title" id="modal-title">Feature title</div>
        <div class="modal-controls">
          <button class="modal-prev" type="button" aria-label="Previous feature">◀ Prev</button>
          <button class="modal-next" type="button" aria-label="Next feature">Next ▶</button>
          <button class="modal-close" type="button" aria-label="Close">✕</button>
        </div>
      </div>
      <div class="modal-body">
        <img src="" alt="" class="modal-img" id="modalImg">
        <div class="modal-text">
          <div id="modalDesc"></div>
          <ul id="modalList"></ul>
        </div>
      </div>
    </div>
  </div>

  <!-- SIMPLE full-image overlay (separate) -->
  <div id="imageOverlay" class="img-overlay" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="viewer" role="document">
      <button class="close-btn" aria-label="Close full image">✕</button>
      <img src="" alt="" id="overlayImg">
      <div class="caption" id="overlayCaption"><em>Caption</em></div>
    </div>
  </div>

<script>
  /* -----------------------
     Feature modal gallery
     (keeps current feature behavior; unchanged)
     ----------------------- */
  const featureCards = Array.from(document.querySelectorAll('.feature-card'));
  const galleryItems = featureCards.map(card => {
    const title = card.querySelector('.feature-title')?.textContent?.trim() || '';
    const body = card.querySelector('.feature-body');
    let fullSrc = body?.getAttribute('data-full') || '';
    if (!fullSrc) {
      const img = body?.querySelector('img');
      const vid = body?.querySelector('video source');
      if (img) fullSrc = img.getAttribute('src') || img.src || '';
      else if (vid) fullSrc = vid.getAttribute('src') || '';
    }
    const paragraphs = Array.from(body?.querySelectorAll('.feature-text p')||[]).map(p=>p.textContent.trim()).filter(Boolean);
    const listItems = Array.from(body?.querySelectorAll('.feature-text ul li')||[]).map(li=>li.textContent.trim()).filter(Boolean);
    const excerpt = card.querySelector('.feature-excerpt')?.textContent?.trim() || '';
    return { title, fullSrc, paragraphs: paragraphs.length ? paragraphs : (excerpt ? [excerpt] : []), listItems };
  });

  const featureModal = document.getElementById('featureModal');
  const modalTitle = document.getElementById('modal-title');
  const modalDesc = document.getElementById('modalDesc');
  const modalList = document.getElementById('modalList');
  const modalImgContainer = document.querySelector('.modal-body');
  const modalPrev = featureModal.querySelector('.modal-prev');
  const modalNext = featureModal.querySelector('.modal-next');
  const modalClose = featureModal.querySelector('.modal-close');

  let featureIndex = 0;
  function isVideo(src){ return /\.(mp4|webm|ogg)$/i.test(src); }

  function renderFeatureMedia(src, title){
    // remove any existing media nodes
    const existingImg = modalImgContainer.querySelector('img.modal-img');
    const existingVideo = modalImgContainer.querySelector('video.modal-img');
    if (existingImg) existingImg.remove();
    if (existingVideo) existingVideo.remove();

    if (!src) {
      const placeholder = document.createElement('div');
      placeholder.className = 'modal-img';
      placeholder.style.minHeight = '220px';
      placeholder.style.display = 'flex';
      placeholder.style.alignItems = 'center';
      placeholder.style.justifyContent = 'center';
      placeholder.style.background = '#f4f4f4';
      placeholder.textContent = 'No preview';
      modalImgContainer.insertBefore(placeholder, modalImgContainer.querySelector('.modal-text'));
      return;
    }

    if (isVideo(src)) {
      const video = document.createElement('video');
      video.setAttribute('controls','');
      video.setAttribute('playsinline','');
      video.className = 'modal-img';
      const source = document.createElement('source');
      source.src = src;
      source.type = 'video/mp4';
      video.appendChild(source);
      modalImgContainer.insertBefore(video, modalImgContainer.querySelector('.modal-text'));
      video.muted = true;
      video.play().catch(()=>{});
      return;
    }

    const img = document.createElement('img');
    img.className = 'modal-img';
    img.src = src;
    img.alt = title || '';
    img.onerror = function(){ this.style.opacity = 0.3; };
    modalImgContainer.insertBefore(img, modalImgContainer.querySelector('.modal-text'));
  }

  function openFeatureModal(idx){
    if(idx<0||idx>=galleryItems.length) return;
    featureIndex = idx;
    const item = galleryItems[idx];
    modalTitle.textContent = item.title || 'Feature';
    modalDesc.innerHTML = '';
    if(item.paragraphs && item.paragraphs.length){
      item.paragraphs.forEach(t=>{ const p=document.createElement('p'); p.textContent=t; modalDesc.appendChild(p); });
    } else modalDesc.textContent = item.title || '';
    modalList.innerHTML = '';
    if(item.listItems && item.listItems.length){ item.listItems.forEach(li=>{ const el=document.createElement('li'); el.textContent=li; modalList.appendChild(el); }); }
    renderFeatureMedia(item.fullSrc, item.title);
    featureModal.classList.add('open'); featureModal.setAttribute('aria-hidden','false'); document.body.style.overflow='hidden';
    modalClose.focus();
  }
  function closeFeatureModal(){
    featureModal.classList.remove('open'); featureModal.setAttribute('aria-hidden','true'); document.body.style.overflow='';
    const video = featureModal.querySelector('video'); if(video){ try{video.pause()}catch(e){} video.remove(); }
    // ensure placeholder img returns
    if(!featureModal.querySelector('img.modal-img')) {
      const placeholder = document.createElement('img'); placeholder.className='modal-img'; placeholder.src=''; placeholder.alt=''; featureModal.querySelector('.modal-body').insertBefore(placeholder, featureModal.querySelector('.modal-text'));
    }
  }
  function showPrevFeature(){ openFeatureModal((featureIndex-1+galleryItems.length)%galleryItems.length); }
  function showNextFeature(){ openFeatureModal((featureIndex+1)%galleryItems.length); }

  featureCards.forEach((card, idx)=>{
    card.addEventListener('click', (e)=>{ if(e.target.closest('a')) return; openFeatureModal(idx); });
    card.addEventListener('keydown', (e)=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); openFeatureModal(idx); }});
  });

  modalClose.addEventListener('click', closeFeatureModal);
  modalPrev.addEventListener('click', (e)=>{ e.stopPropagation(); showPrevFeature(); });
  modalNext.addEventListener('click', (e)=>{ e.stopPropagation(); showNextFeature(); });
  featureModal.addEventListener('click', (e)=>{ if(e.target===featureModal) closeFeatureModal(); });
  document.addEventListener('keydown', (e)=>{ if(!featureModal.classList.contains('open')) return; if(e.key==='Escape') closeFeatureModal(); if(e.key==='ArrowLeft') showPrevFeature(); if(e.key==='ArrowRight') showNextFeature(); });

  /* -----------------------
     Full-image simple overlay (separate)
     ----------------------- */
  const fullClickables = Array.from(document.querySelectorAll('.click-to-open'));
  const imageOverlay = document.getElementById('imageOverlay');
  const overlayImg = document.getElementById('overlayImg');
  const overlayCaption = document.getElementById('overlayCaption');
  const overlayClose = imageOverlay.querySelector('.close-btn');

  function openImageOverlay(src, caption){
    overlayImg.src = src || '';
    overlayImg.alt = caption || '';
    overlayCaption.innerHTML = '<em>' + (caption || '') + '</em>';
    imageOverlay.classList.add('open');
    imageOverlay.setAttribute('aria-hidden','false');
    document.body.style.overflow = 'hidden';
    overlayClose.focus();
  }
  function closeImageOverlay(){
    imageOverlay.classList.remove('open');
    imageOverlay.setAttribute('aria-hidden','true');
    overlayImg.src = '';
    overlayCaption.textContent = '';
    document.body.style.overflow = '';
  }

  fullClickables.forEach(el=>{
    el.addEventListener('click', (e)=>{
      e.preventDefault();
      const src = el.getAttribute('data-full') || el.querySelector('img')?.getAttribute('src') || '';
      const caption = el.getAttribute('data-caption') || el.querySelector('figcaption em')?.textContent || el.querySelector('.caption em')?.textContent || '';
      openImageOverlay(src, caption);
    });
    el.addEventListener('keydown', (e)=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); const src = el.getAttribute('data-full') || el.querySelector('img')?.getAttribute('src') || ''; const caption = el.getAttribute('data-caption') || el.querySelector('figcaption em')?.textContent || el.querySelector('.caption em')?.textContent || ''; openImageOverlay(src, caption); }});
  });

  overlayClose.addEventListener('click', closeImageOverlay);
  imageOverlay.addEventListener('click', (e)=>{ if(e.target === imageOverlay) closeImageOverlay(); });
  document.addEventListener('keydown', (e)=>{ if(!imageOverlay.classList.contains('open')) return; if(e.key==='Escape') closeImageOverlay(); });

  // small accessibility: stop focus from going to page behind modal
  // (already focusing close button on open above)
</script>

</body>
</html>
